<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>bes: Welcome to the Hyrax sql_handler</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">bes
   &#160;<span id="projectnumber">Updated for version 3.20.8-314</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_modules_sql_handler_README.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Welcome to the Hyrax sql_handler </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This handler reads data from a database suing an ODBC driver. There are many different database tools that support access using ODBC.</p>
<h2>Additional Required Software</h2>
<p>In addition to the Hyrax server, you will need a database that can be accessed using ODBC and an ODBC driver for that database that is compatible with the unixODBC software package. This includes most Relational Database Management Systems (RDBMS) as well as many other interesting tools, including NoSQL databases like MongoDB.</p>
<p>If your computer does not have the unixODBC driver software installed, see 'Installing ODBC on your Hyrax server' below. To build the Hyrax sql handler, you only need the generic components of unixODBC to be installed. However, to actually serve data from a database, you will need the appropriate (database specific) driver.</p>
<h2>Building and Installing the sql_handler</h2>
<p>Unlike most of the BES modules, this handler for SQL data is a separate project. It can be added to the bes/modules directory or built outside of the bes software.</p>
<p>To build the code:</p>
<ul>
<li><code>autoreconf -fiv</code></li>
<li><code>./configure --prefix=$prefix</code></li>
<li><code>make</code></li>
<li><code>make check</code> (See more below)</li>
<li><code>make install</code></li>
</ul>
<p><em>Build Notes</em></p><ul>
<li>The <code>./configure</code> script must find both libdap and the BES. It will use the pkgconfig package manager and, if that fails, look for dap-config and bes-config on the PATH. <b>configure or make doesn't work</b></li>
<li>This will happen if unixODBC is not installed. Only the generic part of unixODBC is needed to configure and build the handler. We suggest you use a binary package from yum, apt-get, or brew (for CentOS, Ubuntu or OSX, respectively). <b>make check doesn't work</b></li>
<li>In order to run <code>make check</code> you will need to install the test database located in <code>install.dir</code><ul>
<li>Install DBMS as needed (See <em>Installing DBMS software on your server</em> below).</li>
<li>Load database tables in install.dir into DBMS? (See <em>Creating the test database</em> below)</li>
<li>**_how to configure odbc.ini etc._**</li>
</ul>
</li>
</ul>
<h2>Installing ODBC on your Hyrax server.</h2>
<p>The <code>sql_handler</code> (and by extension Hyrax) uses <a href="https://en.wikipedia.org/wiki/Open_Database_Connectivity">Open Database Connectivity (ODBC)</a> drivers to access various DBMS systems. Drivers will need to be installed on the Hyrax host system.</p>
<p><b><a href="http://www.unixodbc.org">unixODBC</a></b> - This open source ODBC driver is available:</p><ul>
<li>As a source distribution (utilizes gnu autotools to build)</li>
<li>In the <code>yum</code> inventory for <b>CentOS-6</b> and <b>CentOS-7</b> and</li>
<li>In the <code>homebrew</code> inventory for <b>OSX</b></li>
</ul>
<p>Some DBMS producers provide their own ODBC drivers. <em>See the DBMS sections below.</em></p>
<h2>Configure access to your DBMS</h2>
<p>In order to serve data from a database you need to have a database running to hold the data and respond to queries. If you haven't got that sorted already, here's some info about how to go about it. In the following, we describe how to configure sqlite for use with ODBC drivers. This is overkill in many ways, but it is an almost universal example. In the appendix we include information about PostGreSQL and MySQL.</p>
<p>For this example, we assume you don't have the database installed. Folling these steps you should be able to get a working example.</p>
<h3>Install <a href="https://www.sqlite.org">SQLite</a> if needed</h3>
<p>The SQLite binaries are described as: </p><blockquote class="doxtable">
<p>A bundle of command-line tools for managing SQLite database files, including </p>
</blockquote>
<p>the command-line shell program, the sqldiff program, and the sqlite3_analyzer program.</p>
<p><b>Linux</b></p><ul>
<li><b><a href="https://www.sqlite.org/download.html">Latest Binaries</a></b> (Current version 3.28.0)</li>
<li>Also available via: <b>yum</b> (<em>Current available version on CentOS-7 is 3.7.17</em>)</li>
</ul>
<p><b>OSX</b></p><ul>
<li><b><a href="https://www.sqlite.org/download.html">Latest Binaries</a></b></li>
<li>Also available via: <b>Homebrew</b></li>
<li>Use <code>brew install sqlite</code> but note that OSX already has sqlite3, which is an older version of the code, so you need to modify the PATH environment variable like this: <code>export PATH="/usr/local/opt/sqlite/bin:$PATH"</code> and probably put that into <code>.bashrc</code> as well.</li>
<li>Install the sqliteodbc drivers using <code>brew install sqliteodbc</code></li>
</ul>
<h2>Configure the ODBC drvier and database</h2>
<p>There are some example <code>odbc.ini</code> and <code>odbcinst.ini</code> files in the <code>install.dir</code> directory, including ones for sqlite's ODBC driver. These two files configure the unixODBC driver.</p>
<ul>
<li>See <a href="https://sqlite.org/cli.html">Command Line Shell For SQLite</a> for help with the sqlite command shell.</li>
<li><code>odbcinst.ini</code> - Defines driver options; it creates an association between an odbc driver and a dbms. Location: <code>/etc/odbcinst.ini</code> or <code>/usr/local/etc/odbcinst.ini</code></li>
<li>See the <a href="https://www.systutorials.com/docs/linux/man/1-odbcinst/">odbcinst</a> tool for an alternative way to provide this information (i.e., no editing a config file).</li>
<li><code>odbc.ini</code> - Defines connection options; it creates view into the database and exposes it via the ODBC interface. Location: <code>/etc/odbc.ini</code>, <code>/usr/local/etc/odbc.ini</code>, or <code>$HOME/.odbc.ini</code></li>
</ul>
<p>The <code>sqlite_odbcinst.ini</code> should be renamed to <code>odbcinst.ini</code> and copied to <code>/etc</code> or <code>/usr/local/etc</code>. It holds the following: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[SQLite]</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Description=SQLite ODBC Driver</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Driver=/usr/local/lib/libsqlite3odbc.so</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Setup=/usr/local/lib/libsqlite3odbc.so</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Threading=2</div></div><!-- fragment --><p>Note that one <code>odbcinst.ini</code> can hold information for several database/driver combinations. Separate different sections of the file for different databases using [&lt;name&gt;]</p>
<p>The <code>sqlite_odbc.ini</code> should be renamed to <code>odbc.ini</code> and also copied to /etc or /usr/local/etc. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[sqlite_test]</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Description=My SQLite test database</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Driver=SQLite</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Database=/Users/jimg/src/opendap/hyrax_git/bes/modules/sql_handler/tests/sqlite_test.db</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;# optional lock timeout in milliseconds</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Timeout=2000</div></div><!-- fragment --><ul>
<li>The code includes the <code>sqlite_test.db</code> in the <code>sql_handler/tests/</code> directory. This database is used for the sqlite-based tests.</li>
<li>There is a SQL script in <code>install.dir</code> named <code>sqlh.sql</code> that can build the needed database if needed.</li>
<li>The name used in <code>odbc.ini</code> (e.g., <code>[sqlite_test]</code> above) is used in a 'dataset' file that enables much of SQL to be used when connecting one or more tables from the database to Hyrax via the sql_handler.</li>
<li>Dataset files show up as 'data files' and can be browsed and accessed just like any other OPeNDAP data set.</li>
<li>There are sample 'dataset' files in the sql_hanlder/data directory. Each ends in the extension <code>.sql</code> even though they are not SQL program files.</li>
<li>You can change the extensions used by the handler by editing the TypeMatch regular expression in the <code>sql.conf</code> file used to configure the handler.</li>
<li>See <a href="https://www.systutorials.com/docs/linux/man/1-isql/">isql</a> for a command line tool to help debug the ODBC driver configuration. For the test database, <code>isql sqlite_test</code> should return the following: <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;+---------------------------------------+</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;| Connected!                            |</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;|                                       |</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;| sql-statement                         |</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;| help [tablename]                      |</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;| quit                                  |</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;|                                       |</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;+---------------------------------------+</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;SQL&gt; </div></div><!-- fragment --> You can enter commands at teh <code>SQL&gt;</code> prompt. The command <code>help sqlh_table</code> should print information about the table in the test sqlite database.</li>
</ul>
<p>This is one of the sample 'dataset' files (<code>data/sqlite.sql</code>): </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# Test variable definitions</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;# Set DSN to the name in square brackets in odbc.init.</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;# For the sqlite example bundled with the handler, that is [sqlite_test].</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;define $DSN$=sqlite_test</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;[section]</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;api=odbc</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;server=$DSN$</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;# The user and pass keywords are not needed </div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;# user=root</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;# pass=opendap</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;[select]</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;a, b, c</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;[from]</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;sqlh_table</div></div><!-- fragment --><h1>Appendix: Field notes on testing with PostGreSQL and MySQL</h1>
<h2><a href="https://www.enterprisedb.com">PostGreSQL</a></h2>
<p><b>Linux</b></p><ul>
<li><b><a href="https://www.enterprisedb.com/downloads/postgres-postgresql-downloads">All Versions</a></b></li>
<li>Also available via <b>yum</b> (<em>Current available version on AWS CentOS-7 is 9.2.24</em>)</li>
</ul>
<p><b>OSX</b></p><ul>
<li><b><a href="https://www.enterprisedb.com/downloads/postgres-postgresql-downloads">All Versions</a></b> (Package Installer)</li>
<li>Also available via: <b>Homebrew</b> (Currently 11.2)</li>
<li>There is also a <b><a href="https://postgresapp.com">PostGres Menubar App for OSX</a></b> that creates menubar controls for the PostGres DBMS (conflicts with the package installer version of the DB)</li>
</ul>
<p><b><a href="https://odbc.postgresql.org">PostGreSQL ODBC Implementation</a></b> - <a href="https://www.postgresql.org/ftp/odbc/versions/">All Versions</a> <em>Caveat Emptor</em>: It would appear that this archive contains Windows binaries and source code for the rest (Linuix etc.).</p>
<h2><a href="https://dev.mysql.com">MySQL</a></h2>
<p><b>Linux</b></p>
<p>Available as a generic binary download.</p><ul>
<li><b><a href="https://dev.mysql.com/doc/refman/5.7/en/binary-installation.html">Version 5.7</a></b></li>
<li><b><a href="https://dev.mysql.com/doc/refman/8.0/en/binary-installation.html">Version 8.0</a></b></li>
</ul>
<p>Not currently available via <b>yum</b> on AWS CentOS-7</p>
<p><b>OSX</b></p>
<p>Available as either as either a package installer or tar archive download.</p><ul>
<li><b><a href="https://dev.mysql.com/doc/refman/5.7/en/osx-installation.html">Version 5.7</a></b></li>
<li><b><a href="https://dev.mysql.com/doc/refman/8.0/en/osx-installation.html">Version 8.0</a></b></li>
</ul>
<p>Also available via: <b>Homebrew</b> (Currently: 8.0.15)</p>
<h2>Examples</h2>
<p>These examples include building a database that can be used with the tests. Following one of these will result in a configuration such that <code>make check</code> should work.</p>
<h3>PostGreSql 11.4 on OSX 10.13.6</h3>
<ul>
<li>Installed using <a href="https://www.enterprisedb.com/downloads/postgres-postgresql-downloads">the OSX package installer located here</a></li>
<li>If installing using homebrew on OSX, the rest of the Postgresql instructions worked <em>but</em> manually adding the 'postgres' user was needed. To do this use the command:</li>
</ul>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;/usr/local/opt/postgres/bin/createuser -s postgres</div></div><!-- fragment --><p>WARNING: The <a href="https://postgresapp.com">PostGres Menubar App for OSX</a> will not work with the software installed by the package installer.</p>
<h4>Creating the test database</h4>
<ul>
<li>Created <code>test</code> database using the <b>pgAdmin</b> application. (or <code>pg_ctl -D /usr/local/var/postgres start</code> and then <code>createdb test</code> for homebrew installs)</li>
<li>Opened the SQL Shell (<code>psql</code>) application and connected to the <code>test</code> database.</li>
<li>Using the cut buffer I copied all but the first line (which selects which database to connect to, and accomplished in the previous step) from the <code>sglh.sql</code> file, and pasted those lines into the <code>psql</code> shell. This successfully created the table and values for the tests.</li>
</ul>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;CREATE TABLE sqlh_table </div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;(a integer NOT NULL DEFAULT 0,</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;b real NOT NULL DEFAULT 0,</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;c varchar(50),</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;CONSTRAINT pk PRIMARY KEY (a));</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;INSERT INTO sqlh_table(a, b, c) VALUES (&#39;1&#39;, &#39;81.0&#39;, &#39;string_a&#39;), (&#39;2&#39;, &#39;61.1&#39;, &#39;string_b&#39;), (&#39;3&#39;, &#39;51.0&#39;, &#39;string_c&#39;), (&#39;4&#39;, &#39;2100.0&#39;, &#39;string_d&#39;), (&#39;5&#39;, &#39;21.0&#39;, &#39;string_e&#39;), (&#39;6&#39;, &#39;4133.0&#39;, &#39;string_f&#39;), (&#39;7&#39;, &#39;31.4&#39;, &#39;string_g&#39;), (&#39;8&#39;, &#39;21.3&#39;, &#39;string_h&#39;), (&#39;9&#39;, &#39;11.6&#39;, &#39;string_i&#39;), (&#39;10&#39;, &#39;22.2&#39;, &#39;string_j&#39;);</div></div><!-- fragment --><h4>Setting up ODBC</h4>
<h5>Installed <a href="http://www.unixodbc.org">unixODBC</a></h5>
<p>I used Homebrew to install unixODBC:</p><ul>
<li><code>brew install unixodbc</code></li>
</ul>
<h5>Installed the PostgreSQL ODBC driver.</h5>
<ul>
<li>Downloaded the <a href="https://odbc.postgresql.org">PostGreSQL ODBC Implementation</a> source bundle.</li>
<li>Followed the instructions <a href="https://odbc.postgresql.org/docs/unix-compilation.html">here</a></li>
</ul>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;./configure</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;make</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;make install</div></div><!-- fragment --> <h5>Configuration</h5>
<p>The ODBC configuration is held in two files:</p><ul>
<li><code>/usr/local/etc/odbcinst.ini</code> which defines the dbms connection</li>
<li><code>/usr/local/etc/odbc.ini</code> which defines the view of a database to the system.</li>
</ul>
<p>Example <code>/usr/local/etc/odbcinst.ini</code>:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[PostgreSQL]</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Description=PostgreSQL ODBC driver</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Driver=/usr/local/lib/psqlodbca.so</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;debug=0</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Threading=2</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;UsageCount=1</div></div><!-- fragment --><p> Example <code>/usr/local/etc/odbc.ini</code>:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[test]</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Driver              = PostgreSQL</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Description         = LocalPostgres</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Trace               = Yes</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;TraceFile           = sql.log</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Database            = test</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;Servername          = localhost</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;UserName            = postgres</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;Password            = foobar</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;Port                = 5432</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;Protocol            = 8.4</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;ReadOnly            = No</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;RowVersioning       = No</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;ShowSystemTables    = No</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;ShowOidColumn       = No</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;FakeOidIndex        = No</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;ConnSettings        =</div></div><!-- fragment --><h5>Test</h5>
<p>At this point I was able to get the <code>isql</code> application to run and return the correct data:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[-bash: ~/OPeNDAP/hyrax/sql_handler] isql -v test</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;+---------------------------------------+</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;| Connected!                            |</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;|                                       |</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;| sql-statement                         |</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;| help [tablename]                      |</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;| quit                                  |</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;|                                       |</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;+---------------------------------------+</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;SQL&gt; SELECT a,b,c FROM  sqlh_table;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;+------------+----------------+---------------------------------------------------+</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;| a          | b              | c                                                 |</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;+------------+----------------+---------------------------------------------------+</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;| 1          | 81             | string_a                                          |</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;| 2          | 61.099998      | string_b                                          |</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;| 3          | 51             | string_c                                          |</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;| 4          | 2100           | string_d                                          |</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;| 5          | 21             | string_e                                          |</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;| 6          | 4133           | string_f                                          |</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;| 7          | 31.4           | string_g                                          |</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;| 8          | 21.299999      | string_h                                          |</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;| 9          | 11.6           | string_i                                          |</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;| 10         | 22.200001      | string_j                                          |</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;+------------+----------------+---------------------------------------------------+</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;SQLRowCount returns 10</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;10 rows fetched</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;SQL&gt; </div></div><!-- fragment --><p> NOTE: One can fiddle with the <code>odbc.ini</code> file and see the effects. For example, changing the name of the Datassource from <code>[test]</code> to <code>[foo]</code> should produce the following results:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[-bash: ~/OPeNDAP/hyrax/sql_handler] isql -v test</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;[IM002][unixODBC][Driver Manager]Data source name not found and no default driver specified</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;[ISQL]ERROR: Could not SQLConnect</div></div><!-- fragment --><p>and</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[-bash: ~/OPeNDAP/hyrax/sql_handler] isql -v foo</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;+---------------------------------------+</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;| Connected!                            |</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;|                                       |</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;| sql-statement                         |</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;| help [tablename]                      |</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;| quit                                  |</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;|                                       |</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;+---------------------------------------+</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;SQL&gt; SELECT a,b,c FROM  sqlh_table;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;+------------+----------------+---------------------------------------------------+</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;| a          | b              | c                                                 |</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;+------------+----------------+---------------------------------------------------+</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;| 1          | 81             | string_a                                          |</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;| 2          | 61.099998      | string_b                                          |</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;| 3          | 51             | string_c                                          |</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;| 4          | 2100           | string_d                                          |</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;| 5          | 21             | string_e                                          |</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;| 6          | 4133           | string_f                                          |</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;| 7          | 31.4           | string_g                                          |</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;| 8          | 21.299999      | string_h                                          |</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;| 9          | 11.6           | string_i                                          |</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;| 10         | 22.200001      | string_j                                          |</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;+------------+----------------+---------------------------------------------------+</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;SQLRowCount returns 10</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;10 rows fetched</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;SQL&gt; </div></div><!-- fragment --><p>After changing the Datasource source BACK to <code>[test]</code> I saw that at this point the first three tests began to return valid content so I made baselines:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[-bash: ~/OPeNDAP/hyrax/sql_handler/tests] make chec</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;[-bash: ~/OPeNDAP/hyrax/sql_handler/tests] ./testsuite 1 2 3</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;## ----------------------------------------------------------- ##</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;## sql_module 1.0.0 test suite: bes.conf besstandalone getdap. ##</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;## ----------------------------------------------------------- ##</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  1: BESCMD postgresql.das.bescmd                       ok</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  2: BESCMD postgresql.dds.bescmd                       ok</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  3: BESCMD postgresql.ddx.bescmd                       ok</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;## ------------- ##</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;## Test results. ##</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;## ------------- ##</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;All 3 tests were successful.</div></div><!-- fragment --><h3>MySQL Ver 8.0.17 for Linux on x86_64 (MySQL Community Server - GPL)</h3>
<p><em>Installed on CentOS-7 latest running in an AWS EC2 instance.</em> </p><blockquote class="doxtable">
<p>NOTE: I disabled SELinux on this system to simplify my installation/configuration experience. </p>
</blockquote>
<h4>Installation</h4>
<p>There are a bewildering number of ways to install MySQL on Linux. However, the most obvious one, <b>yum</b>, is not by default connected to the MySQL repository. The <a href="https://dev.mysql.com/doc/refman/8.0/en/linux-installation.html">MySQL Linux Installation Guide</a> directs one to connect the MySQL repo to your system. IN a case of misunderstanding I downloaded the <em>Red Hat Enterprise Linux 7 / Oracle Linux 7 (x86, 64-bit), RPM Bundle</em> from the <b>Red Hat Enterprise</b> section of this page: <a href="https://dev.mysql.com/downloads/mysql/">https://dev.mysql.com/downloads/mysql/</a> The installation required that <em>all</em> of the included rpms be named on the installation command:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;tar -xvf mysql-8.0.17-1.el7.x86_64.rpm-bundle.tar;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;sudo yum install *.rpm; # Note that the tar ball unpacks all the rpms into the CWD</div></div><!-- fragment --><p> This successfully install the software.</p>
<h4>Start the MySQL daemon, <em>mysqld</em></h4>
<p>In order to start the service:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sudo service start mysqld</div></div><!-- fragment --><h4>Deal with the mysql <em>root</em> user password</h4>
<p>After much trashing about I discover that the "root" password for the MySQL service is randomly generated and written to the error log. In order to recover it, perform the following:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;% sudo grep &#39;temporary password&#39; /var/log/mysqld.log</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;2019-10-07T19:06:18.810367Z 5 [Note] [MY-010454] [Server] A temporary password is generated for root@localhost: I_AOA_()d7e0</div></div><!-- fragment --><p> Changing the password goes like this:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;% sudo mysql -uroot -p</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Enter password: </div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Welcome to the MySQL monitor.  Commands end with ; or \g.</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Your MySQL connection id is 24</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Server version: 8.0.17</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;Oracle is a registered trademark of Oracle Corporation and/or its</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;affiliates. Other names may be trademarks of their respective</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;owners.</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;mysql&gt; ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;Your!Spiffy!New!Password123&#39;;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;Query OK, 0 rows affected (0.00 sec)</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;mysql&gt; quit</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;Bye</div></div><!-- fragment --><h4>Create and populate the <em>test</em> database</h4>
<p>Login as the mysql <em>root</em> user:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;% mysql -uroot -p</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Enter password: </div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Welcome to the MySQL monitor.  Commands end with ; or \g.</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Your MySQL connection id is 26</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Server version: 8.0.17 MySQL Community Server - GPL</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;Oracle is a registered trademark of Oracle Corporation and/or its</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;affiliates. Other names may be trademarks of their respective</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;owners.</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.</div></div><!-- fragment --><p> Create and select the the <em>test</em> database:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;mysql&gt; CREATE DATABASE test;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Query OK, 1 row affected (0.00 sec)</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;mysql&gt; USE test;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Database changed</div></div><!-- fragment --><p> Create the the table <em>sqlh_table</em>:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;mysql&gt; CREATE TABLE sqlh_table </div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    -&gt; (a integer NOT NULL DEFAULT 0,</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    -&gt; b real NOT NULL DEFAULT 0,</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    -&gt; c varchar(50),</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    -&gt; CONSTRAINT pk PRIMARY KEY (a));</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Query OK, 0 rows affected (0.02 sec)</div></div><!-- fragment --><p> Populate the table <em>sqlh_table</em> with data:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;mysql&gt; INSERT INTO sqlh_table(a, b, c) VALUES (&#39;1&#39;, &#39;81.0&#39;, &#39;string_a&#39;), (&#39;2&#39;, &#39;61.1&#39;, &#39;string_b&#39;), (&#39;3&#39;, &#39;51.0&#39;, &#39;string_c&#39;), (&#39;4&#39;, &#39;2100.0&#39;, &#39;string_d&#39;), (&#39;5&#39;, &#39;21.0&#39;, &#39;string_e&#39;), (&#39;6&#39;, &#39;4133.0&#39;, &#39;string_f&#39;), (&#39;7&#39;, &#39;31.4&#39;, &#39;string_g&#39;), (&#39;8&#39;, &#39;21.3&#39;, &#39;string_h&#39;), (&#39;9&#39;, &#39;11.6&#39;, &#39;string_i&#39;), (&#39;10&#39;, &#39;22.2&#39;, &#39;string_j&#39;);</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Query OK, 10 rows affected (0.01 sec)</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Records: 10  Duplicates: 0  Warnings: 0</div></div><!-- fragment --><p>Now we need a test user because doing everything as <em>root</em> is probably ill advised: From <a href="https://dev.mysql.com/doc/refman/8.0/en/creating-accounts.html">Creating Accounts</a></p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;mysql -u root -p</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Enter password: </div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  ...</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;mysql&gt; CREATE USER &#39;mysql&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;mysqlUserPasswordHere&#39;;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Query OK, 0 rows affected (0.01 sec)</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;mysql&gt; GRANT SELECT ON *.* TO &#39;mysql&#39;@&#39;localhost&#39; WITH GRANT OPTION;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;Query OK, 0 rows affected (0.00 sec)</div></div><!-- fragment --><p>That should be enough to get the tests working, so quit the MySQL client for now:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;mysql&gt; quit;</div></div><!-- fragment --> <h4>Configure the ODBC faffery</h4>
<p>I found <code>odbcinst.ini</code> like so:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[root@ip-172-31-9-74 etc]# find / -type f -name odbcinst.ini</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;/etc/odbcinst.ini</div></div><!-- fragment --><p> And this is its content:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[PostgreSQL]</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Description=ODBC for PostgreSQL</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Driver=/usr/lib/psqlodbcw.so</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Setup=/usr/lib/libodbcpsqlS.so</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Driver64=/usr/lib64/psqlodbcw.so</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Setup64=/usr/lib64/libodbcpsqlS.so</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;FileUsage=1</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;[MySQL]</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;Description=ODBC for MySQL</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;Driver=/usr/lib/libmyodbc5.so</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;Setup=/usr/lib/libodbcmyS.so</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;Driver64=/usr/lib64/libmyodbc5.so</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;Setup64=/usr/lib64/libodbcmyS.so</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;FileUsage=1</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;[MySQL ODBC 8.0 Unicode Driver]</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;Driver=/usr/lib64/libmyodbc8w.so</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;SETUP=/usr/lib64/libmyodbc8S.so</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;UsageCount=1</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;[MySQL ODBC 8.0 ANSI Driver]</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;Driver=/usr/lib64/libmyodbc8a.so</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;SETUP=/usr/lib64/libmyodbc8S.so</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;UsageCount=1</div></div><!-- fragment --><p>So I added odbc.ini in the same spot with the same permissions:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[root@ip-172-31-9-74 etc]# touch /etc/odbc.ini</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;[root@ip-172-31-9-74 etc]# chmod 644 !$</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;chmod 644 /etc/odbc.ini</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;[root@ip-172-31-9-74 etc]# ls -l /etc/odbc*</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;-rw-r--r--. 1 root root   0 Oct  8 14:01 /etc/odbc.ini</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;-rw-r--r--. 1 root root 579 Jun 11 23:20 /etc/odbcinst.ini</div></div><!-- fragment --><h4>Get and install the MySQL ODBC connector</h4>
<p>Retrieve the appropriate <b>files</b> from: <a href="https://dev.mysql.com/downloads/connector/odbc/">MySQL ODBC Connector Downlods</a></p>
<p>This requires two separete RPM downloads:</p>
<ul>
<li>mysql-connector-odbc-8.0.17-1.el7.i686.rpm</li>
<li>mysql-connector-odbc-setup-8.0.17-1.el7.i686.rpm</li>
</ul>
<p>This page <a href="https://dev.mysql.com/doc/connector-odbc/en/connector-odbc-configuration-connection-parameters.html">MySQL ODC Connector Configuration</a> was of little use, and after a ridculaous amount of additonal thrashing I found that the <code>odbcinst.ini</code> file had to be modified to accomodate the new drivers:</p>
<p>OLD:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[MySQL]</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Description=ODBC for MySQL</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Driver=/usr/lib/libmyodbc5.so</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Setup=/usr/lib/libodbcmyS.so</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Driver64=/usr/lib64/libmyodbc5.so</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Setup64=/usr/lib64/libodbcmyS.so</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;FileUsage=1</div></div><!-- fragment --><p> NEW:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[MySQL]</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Description=ODBC for MySQL</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Driver=/usr/lib/libmyodbc8w.so</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Setup=/usr/lib/libodbcmyS.so</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Driver64=/usr/lib64/libmyodbc8w.so</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Setup64=/usr/lib64/libodbcmyS.so</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;FileUsage=1</div></div><!-- fragment --><p>Next I edited the <code>/etc/odbc.ini</code> and added the test database like so:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[test]</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Driver              = MySQL</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Description         = LocalMySQL</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Trace               = Yes</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;TraceFile           = sql.log</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Database            = test</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;Servername          = localhost</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;UserName            = mysql</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;Password            = *************</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;Port                = 3306</div></div><!-- fragment --><p>After which I was able to connect to the DB using the <code>isql</code> ODBC application:</p>
<p>Invoke <code>isql</code> on the "test" ODBC connection as the user "mysql" with password "passwordy"</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;% isql test mysql passwordy</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;+---------------------------------------+</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;| Connected!                            |</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;|                                       |</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;| sql-statement                         |</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;| help [tablename]                      |</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;| quit                                  |</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;|                                       |</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;+---------------------------------------+</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;SQL&gt; help sqlh_table</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;+-----------------------------------------------------------------+-----------------------------------------------------------------+-----------------------------------------------------------------+-----------------------------------------------------------------+----------+---------------------+------------+--------------+---------------+---------------+---------+-----------------------------------------------------------------+-----------------------------------------------------------------+--------------+-----------------+------------------+-----------------+------------+</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;| TABLE_CAT                                                       | TABLE_SCHEM                                                     | TABLE_NAME                                                      | COLUMN_NAME                                                     | DATA_TYPE| TYPE_NAME           | COLUMN_SIZE| BUFFER_LENGTH| DECIMAL_DIGITS| NUM_PREC_RADIX| NULLABLE| REMARKS                                                         | COLUMN_DEF                                                      | SQL_DATA_TYPE| SQL_DATETIME_SUB| CHAR_OCTET_LENGTH| ORDINAL_POSITION| IS_NULLABLE|</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;+-----------------------------------------------------------------+-----------------------------------------------------------------+-----------------------------------------------------------------+-----------------------------------------------------------------+----------+---------------------+------------+--------------+---------------+---------------+---------+-----------------------------------------------------------------+-----------------------------------------------------------------+--------------+-----------------+------------------+-----------------+------------+</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;|                                                                 |                                                                 | sqlh_table                                                      | a                                                               | 4        | integer             | 10         | 4            | 0             | 10            | 0       |                                                                 | 0                                                               | 4            |                 |                  | 1               | NO         |</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;|                                                                 |                                                                 | sqlh_table                                                      | b                                                               | 8        | double              | 15         | 8            |               |               | 0       |                                                                 | 0                                                               | 8            |                 |                  | 2               | NO         |</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;|                                                                 |                                                                 | sqlh_table                                                      | c                                                               | -9       | varchar             | 50         | 200          |               |               | 1       |                                                                 |                                                                 | -9           |                 | 200              | 3               | YES        |</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;+-----------------------------------------------------------------+-----------------------------------------------------------------+-----------------------------------------------------------------+-----------------------------------------------------------------+----------+---------------------+------------+--------------+---------------+---------------+---------+-----------------------------------------------------------------+-----------------------------------------------------------------+--------------+-----------------+------------------+-----------------+------------+</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;SQLRowCount returns 3</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;3 rows fetched</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;SQL&gt; select * from sqlh_table</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;+-----------+-------------------------+---------------------------------------------------+</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;| a         | b                       | c                                                 |</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;+-----------+-------------------------+---------------------------------------------------+</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;| 1         | 81                      | string_a                                          |</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;| 2         | 61.1                    | string_b                                          |</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;| 3         | 51                      | string_c                                          |</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;| 4         | 2100                    | string_d                                          |</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;| 5         | 21                      | string_e                                          |</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;| 6         | 4133                    | string_f                                          |</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;| 7         | 31.4                    | string_g                                          |</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;| 8         | 21.3                    | string_h                                          |</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;| 9         | 11.6                    | string_i                                          |</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;| 10        | 22.2                    | string_j                                          |</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;+-----------+-------------------------+---------------------------------------------------+</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;SQLRowCount returns 10</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;10 rows fetched</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;SQL&gt; </div></div><!-- fragment --><p> woot.</p>
<p>(That was ridculous, unneccessarily complex, and non-intuitive)</p>
<p>AT this point I had to revist the <code>sql_handler</code> code because there were issues with authentication. I re-enabled the authentication (see ODBCConnecor.cc lines 70-94) and added the "data" file data/mysql.sql With the correct user and passoword installed in the aforementioned file the handler was able to connect to the MySQL service.</p>
<p>At this point the code apears to be failing because of an unanticipated data type.</p>
<p>Running any of these commands in the tests directory:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;besstandalone -c bes.conf -d &quot;cerr,all&quot; -i sql/mysql.dds.bescmd</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;besstandalone -c bes.conf -d &quot;cerr,all&quot; -i sql/mysql.das.bescmd</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;besstandalone -c bes.conf -d &quot;cerr,all&quot; -i sql/mysql.data.bescmd</div></div><!-- fragment --><p> Will produce this error:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;SQLRequestHandler: Error: 7 Message: SQL Handler: The datatype read from the Data Source is not supported. The problem type code is: -8 File: unixODBC/ODBCTypeFactoryComponent.cc Line: 184</div></div><!-- fragment --><p> Hmmmmm</p>
<p>Also of note is that running besstandalone without the debugging enabled does not produce a meaningful messsage:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;<span class="keywordtype">Message</span>&gt;<span class="keyword">SQLRequestHandler:</span> <span class="keyword">Error</span> <span class="keyword">occurred</span>, <span class="keyword">bad</span> <span class="keyword">constraints</span> <span class="keyword">specified</span> <span class="keyword">or</span> <span class="keyword">no</span> <span class="keyword">active</span> <span class="keyword">database</span> <span class="keyword">server</span> <span class="keyword">for</span> <span class="keyword">this</span> <span class="keyword">dataset.</span> <span class="keyword">Please</span>,<span class="keyword">try</span> <span class="keyword">a</span> <span class="keyword">less</span> <span class="keyword">restrictive</span> <span class="keyword">constraint</span> <span class="keyword">or</span> <span class="keyword">contact</span> <span class="keyword">the</span> <span class="keyword">administrator.</span>&lt;/<span class="keywordtype">Message</span>&gt;</div></div><!-- fragment --><p> This should be corrected, in addition to correcting the underlying unanticipated data type bug. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
